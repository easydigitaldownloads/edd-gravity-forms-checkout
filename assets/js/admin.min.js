jQuery(document).ready(function(a){var c=c||{debug:1==+EDDGF.debug,init:function(){var e=c;a(document).on("gform_load_field_settings",e.on_load_field_settings),a("body").on("change","#field_edd_download",e.change_download).on("show change","#product_field,#product_field_type",e.maybe_show_variations).on("mouseup keyup",".edd-gf-get-variations button",e.get_variations)},log:function(e,o){c.debug&&(o=o||null,console.log(e,o))},on_load_field_settings:function(){c.hide_connect_for_options()},hide_connect_for_options:function(){var e=GetSelectedField();"product"!==e.type&&"option"!==e.type&&c.product_hide_all(e)},update_field_choices:function(e){UpdateFieldChoices(e.type),LoadFieldChoices(e)},get_product_field:function(e){if(void 0===e.type||"product"!==e.type&&"option"!==e.type)return c.log("not a product field",e),!1;return void 0===e.productField||""===e.productField?e:GetFieldById(e.productField)},get_variations:function(e){var t,o,d,n=c;"keyup"!==e.type||32===e.keyCode||13===e.keyCode?(t=GetSelectedField(),d=(o=n.get_product_field(t))?o.eddDownload:"",a(".edd-gf-loading").show(),n.log("in edd-gf-get-variations",{field:t,edd_gf_selected_download:d,eddProductField:o}),a.post(ajaxurl,{action:"edd_gf_check_for_variations",download_id:d,nonce:a("#edd_gf_download_nonce").val(),format:"json"}).done(function(e){n.log("Check For Variations Data",e),a(".edd-gf-loading").hide();e=jQuery.parseJSON(e);n.log("parsed JSON price Variable Items",e),0===e.length?(n.log("There were no variations. Reverting to original field choices."),n.restore_field_choices(t)):(t.eddChoicesBackup=t.choices,t.choices=[],a("#field_choice_values_enabled").prop("checked",!0),SetFieldProperty("enableChoiceValue",!0),ToggleChoiceValue(),SetFieldChoices(),a.each(e,function(e,o){n.log("Item being added as Choice",o);var d=GetCurrentCurrency().toMoney(o.amount),i=new Choice;i.text=o.name,i.value=e.toString(),i.price=d,i.isSelected=1===o.default,t.choices.push(i)}),n.update_field_choices(t))}).error(function(e){a(".edd-gf-loading").hide(),n.log("Error loading variations",e)})):n.log("keyCode not space or return.",e.keyCode)},maybe_show_variations:function(e){var o=c,d=GetSelectedField(),i=o.get_product_field(d),t=i?i.eddDownload:"";a("#gfield_settings_choices_container").find(".gfield_choice_header_value").text(EDDGF.text_value),o.log("#"+a(e.target).attr("id")+" "+e.type,{event:e,field:d,edd_gf_selected_download:t,eddProductField:i}),""===t||"0"===t?o.product_hide_all(d):i.eddHasVariables?o.product_has_variables(d):o.product_has_no_variables(d)},product_hide_all:function(e){a(".product-has-variations-message").hide(),a(".edd_gf_connect_variations").slideUp(100),c.restore_field_choices(e)},product_has_variables:function(e){if(c.log("product_has_variables"),a(".edd-gf-get-variations").show(),a(".product-has-variations-message").show(),a(".edd-gf-no-variations-warning").hide(),a(".product-add-option-field").hide(),e.productField=e.productField||"",""===e.productField&&"radio"!==e.inputType&&"select"!==e.inputType)return a(".edd_gf_connect_variations").hide(),void a(".product-add-option-field").show();a("#gfield_settings_choices_container .gfield_choice_header_value").text(EDDGF.text_price_id),a(".edd_gf_connect_variations:hidden").slideDown("fast")},product_has_no_variables:function(e){c.log("product_has_no_variables"),a(".edd-gf-no-variations-warning").hide(),a(".product-has-variations-message").hide(),a(".edd-gf-get-variations").hide(),""!==e.productField||"radio"===e.inputType||"select"===e.inputType?(a(".edd-gf-no-variations-warning").show(),a(".edd_gf_connect_variations:hidden").slideDown("fast")):a(".edd_gf_connect_variations").hide(),c.restore_field_choices(e)},restore_field_choices:function(e){e=c.get_product_field(e);!1!==e?(c.log("In edd_gf_restore_field_choices"),e.eddChoicesBackup?e.choices=e.eddChoicesBackup:void 0===e.choices&&(e.choices=[new Choice("First Option","","0.00"),new Choice("Second Option","","0.00"),new Choice("Third Option","","0.00")]),c.update_field_choices(e),c.log("field",e)):c.log("restore_field_choices: not a product field")},change_download:function(e){var o=c,d=a("option:selected",a(this)).val();SetFieldProperty("eddDownload",d),SetFieldProperty("eddHasVariables",!1),a.isNumeric(d)&&0!==parseInt(d,10)&&a("option:selected",a(this)).attr("data-variations")&&SetFieldProperty("eddHasVariables",!0),o.maybe_show_variations(e)}};c.init()});