jQuery(document).ready(function(a){var b=b||{debug:"1"===EDDGF.debug,init:function(){var c=b;a(document).on("gform_load_field_settings",c.hide_connect_for_options),a("body").on("change","#field_edd_download",c.change_download).on("show change","#product_field,#product_field_type",c.maybe_show_variations).on("mouseup keyup",".edd-gf-get-variations button",c.get_variations)},log:function(a,c){b.debug&&(c=c||null,console.log(a,c))},hide_connect_for_options:function(){var a=GetSelectedField();"product"!==a.type&&"option"!==a.type&&b.product_hide_all(a)},update_field_choices:function(a){UpdateFieldChoices(a.type),LoadFieldChoices(a)},get_product_field:function(a){if("undefined"==typeof a.type||"product"!==a.type&&"option"!==a.type)return b.log("not a product field",a),!1;var c=!1;return c="undefined"==typeof a.productField||""===a.productField?a:GetFieldById(a.productField)},get_variations:function(c){var d=b;if("keyup"===c.type&&32!==c.keyCode&&13!==c.keyCode)return void d.log("keyCode not space or return.",c.keyCode);var e=GetSelectedField(),f=d.get_product_field(e),g=f?f.eddDownload:"";a(".edd-gf-loading").show(),d.log("in edd-gf-get-variations",{field:e,edd_gf_selected_download:g,eddProductField:f}),a.post(ajaxurl,{action:"edd_gf_check_for_variations",download_id:g,nonce:a("#edd_gf_download_nonce").val(),format:"json"}).done(function(b){d.log("Check For Variations Data",b),a(".edd-gf-loading").hide();var c=jQuery.parseJSON(b);d.log("parsed JSON price Variable Items",c),0===c.length?(d.log("There were no variations. Reverting to original field choices."),d.restore_field_choices(e)):(e.eddChoicesBackup=e.choices,e.choices=[],a("#field_choice_values_enabled").prop("checked",!0),SetFieldProperty("enableChoiceValue",!0),ToggleChoiceValue(),SetFieldChoices(),a.each(c,function(a,b){var c=GetCurrentCurrency(),d=c.toMoney(b.amount),f=new Choice;f.text=b.name,f.value=a.toString(),f.price=d,f.isSelected=!1,e.choices.push(f)}),d.update_field_choices(e))}).error(function(b){a(".edd-gf-loading").hide(),d.log("Error loading variations",b)})},maybe_show_variations:function(c){var d=b,e=GetSelectedField(),f=d.get_product_field(e),g=f?f.eddDownload:"";a("#gfield_settings_choices_container").find(".gfield_choice_header_value").text(EDDGF.text_value),d.log("#"+a(c.target).attr("id")+" "+c.type,{event:c,field:e,edd_gf_selected_download:g,eddProductField:f}),""===g||"0"===g?d.product_hide_all(e):f.eddHasVariables?d.product_has_variables(e):d.product_has_no_variables(e)},product_hide_all:function(c){a(".product-has-variations-message").hide(),a(".edd_gf_connect_variations").slideUp(100),b.restore_field_choices(c)},product_has_variables:function(c){return b.log("product_has_variables"),a(".edd-gf-get-variations").show(),a(".product-has-variations-message").show(),a(".edd-gf-no-variations-warning").hide(),a(".product-add-option-field").hide(),c.productField=c.productField||"",""===c.productField&&"radio"!==c.inputType&&"select"!==c.inputType?(a(".edd_gf_connect_variations").hide(),void a(".product-add-option-field").show()):(a("#gfield_settings_choices_container .gfield_choice_header_value").text(EDDGF.text_price_id),void a(".edd_gf_connect_variations:hidden").slideDown("fast"))},product_has_no_variables:function(c){b.log("product_has_no_variables"),a(".edd-gf-no-variations-warning").hide(),a(".product-has-variations-message").hide(),a(".edd-gf-get-variations").hide(),""!==c.productField?(a(".edd-gf-no-variations-warning").show(),a(".edd_gf_connect_variations:hidden").slideDown("fast")):"radio"===c.inputType||"select"===c.inputType?(a(".edd-gf-no-variations-warning").show(),a(".edd_gf_connect_variations:hidden").slideDown("fast")):a(".edd_gf_connect_variations").hide(),b.restore_field_choices(c)},restore_field_choices:function(a){var c=b.get_product_field(a);return!1===c?void b.log("restore_field_choices: not a product field"):(b.log("In edd_gf_restore_field_choices"),c.eddChoicesBackup?c.choices=c.eddChoicesBackup:"undefined"==typeof c.choices&&(c.choices=[new Choice("First Option","","0.00"),new Choice("Second Option","","0.00"),new Choice("Third Option","","0.00")]),b.update_field_choices(c),void b.log("field",c))},change_download:function(c){var d=b,e=a("option:selected",a(this)).val();SetFieldProperty("eddDownload",e),SetFieldProperty("eddHasVariables",!1),a.isNumeric(e)&&0!==parseInt(e,10)&&a("option:selected",a(this)).attr("data-variations")&&SetFieldProperty("eddHasVariables",!0),d.maybe_show_variations(c)}};b.init()});